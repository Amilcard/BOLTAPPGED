{
  "pr_info": {
    "branche": "main",
    "commits": [
      {
        "hash": "9d1d1d0",
        "msg": "feat(payment): Phase 1-2 - DB migration + API Stripe",
        "status": "✅ STABLE (DB only)"
      },
      {
        "hash": "ffa43a3",
        "msg": "feat(payment): Phase 3 - Payment flow integrated",
        "status": "⚠️ RÉGRESSION (booking flow cassé)"
      },
      {
        "hash": "À compléter",
        "msg": "feat(payment): Age validation + debug logs",
        "status": "⚠️ NON TESTÉ"
      }
    ],
    "derniere_version_stable": {
      "hash": "Commit AVANT 9d1d1d0",
      "desc": "Booking flow 100% fonctionnel SANS paiement",
      "action": "git log --oneline -20 pour identifier"
    }
  },
  "tests_regression": {
    "version_test": "Commit avant modifications paiement",
    "commandes": [
      "git log --oneline -20",
      "git checkout <hash_stable>",
      "npm run dev",
      "Tester réservation complète"
    ],
    "checklist_fonctionnelle": [
      "✓ Page séjour charge",
      "✓ Sélection session fonctionne",
      "✓ Sélection ville fonctionne",
      "✓ Modal booking s'ouvre",
      "✓ Étape 1-2-3 remplissables",
      "✓ Validation finale crée réservation",
      "✓ Message succès affiché",
      "✓ Aucune erreur console"
    ],
    "checklist_graphique": [
      "✓ Pas de textes tronqués",
      "✓ Dates formatées correctement (JJ/MM/AAAA)",
      "✓ Prix affichés avec €",
      "✓ Boutons cliquables (pas disabled grisés)",
      "✓ Progress bar cohérente (5 étapes)",
      "✓ Responsive mobile OK"
    ]
  },
  "problemes_actuels": {
    "bloquants": [
      "API /api/inscriptions → erreur 'expected string, received undefined'",
      "Dates affichent 'Invalid Date'",
      "Prix total manquant (juste €)",
      "Impossible de valider réservation"
    ],
    "cause": "Changement /api/bookings → /api/inscriptions sans validation",
    "fichiers_modifies": [
      "components/booking-flow.tsx",
      "app/api/inscriptions/route.ts"
    ]
  },
  "recommandation_immediate": {
    "action": "ROLLBACK",
    "etapes": [
      "git revert <hash_commit_payment_flow>",
      "Vérifier booking fonctionne",
      "Re-intégrer paiement APRÈS validation"
    ],
    "alternative": "Créer branche feature/payment-debug et fixer bugs avant merge"
  },
  "commandes_utiles": {
    "voir_diff": "git diff <hash_stable>..HEAD",
    "rollback_soft": "git reset --soft <hash_stable>",
    "rollback_hard": "git reset --hard <hash_stable>",
    "creer_branche": "git checkout -b feature/payment-fix",
    "push_branche": "git push -u origin feature/payment-fix"
  }
}
